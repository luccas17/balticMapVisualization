<!DOCTYPE html>
<html>
  <head>
    <title>Embedding Vega-Lite</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.25.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.12.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.22.1"></script>
  </head>
  <body>
    <center>
        <div id="vis"></div>
    </center>

<!-- For interacting with the graph https://vega.github.io/vega-lite/docs/selection.html-->

    <script type="text/javascript">
        var yourVlSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 1200,
            "height": 800,
            "layer": [
                {
                "data": {
                    "url": "https://raw.githubusercontent.com/deldersveld/topojson/master/continents/europe.json",
                    "format": {"type": "topojson", "feature": "continent_Europe_subunits"}
                },
                "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "gray"}
                },
                {
                "data": {
                    "url": "https://luccas17.github.io/vegaliteBalticMap/data/odin2_2023-08-28_113735_comma.csv"
                },
                "transform": [
                    {
                    "aggregate": [{
                    "op": "mean",
                    "field": "Latitude",
                    "as": "mean_latitude"
                    }, 
                    {
                        "op": "mean",
                        "field": "Longitude",
                        "as": "mean_longitude"
                    },
                    {
                        "op": "mean",
                        "field": "Temperature",
                        "as": "mean_temp"
                    }],
                    "groupby": ["Station name"]
                    },
                    {
                    "calculate": "'hsl('+(14-datum.mean_temp)*24+', 100%, 50%)'", 
                    "as": "color"
                    }
                ],
                "mark": {
                "type": "circle",
                "size": 100
                },
                "encoding": {
                    "longitude": {
                        "field": "mean_longitude"
                    },
                    "latitude": {
                        "field": "mean_latitude"
                    },
                    "tooltip": [{
                        "field": "Station name"
                    }],
                    "color": {
                    "field": "color"
                    }
                }
                }
            ]
            }
        vegaEmbed('#vis', yourVlSpec);
    </script>
  </body>
</html>